!function e(t,o,n){function r(a,i){if(!o[a]){if(!t[a]){var l="function"==typeof require&&require;if(!i&&l)return l(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=o[a]={exports:{}};t[a][0].call(s.exports,function(e){var o=t[a][1][e];return r(o?o:e)},s,s.exports,e,t,o,n)}return o[a].exports}for(var c="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e){var t,o,n,r,c;t=angular.module("mampfApp",["onsen.directives","ngTouch","ngMd5","ui.map","angularLocalStorage"]),o={config:e("./config/static.coffee"),constants:e("./config/constants.coffee"),_:window._},t.constant(o),c={device:e("./factories/device.coffee"),cordovaReady:e("./factories/cordova_ready.coffee"),contactChooser:e("./factories/contact_chooser.coffee"),geoLocation:e("./factories/geolocation.coffee"),sharedData:e("./factories/shared_data.coffee"),server:e("./factories/server.coffee")},t.factory(c),n={ContactListCtrl:e("./controllers/contacts/contact_list_ctrl.coffee"),ContactDetailsCtrl:e("./controllers/contacts/contact_details_ctrl.coffee"),LunchRequestCtrl:e("./controllers/lunch/lunch_request_ctrl.coffee"),LunchResponseCtrl:e("./controllers/lunch/lunch_response_ctrl.coffee"),ChooseLocationCtrl:e("./controllers/lunch/choose_location_ctrl.coffee"),ChooseContactCtrl:e("./controllers/lunch/choose_contact_ctrl.coffee"),ProfileCtrl:e("./controllers/profile/profile_ctrl.coffee"),AddLocationCtrl:e("./controllers/profile/add_location_ctrl.coffee"),ShowLocationsCtrl:e("./controllers/profile/show_locations_ctrl.coffee"),LocationDetailCtrl:e("./controllers/profile/location_detail_ctrl.coffee")},t.controller(n),r={sharedValidate:e("./directives/shared_validate.coffee")},t.directive(r),window.onGoogleReady=function(){return console.log("google rdy"),angular.bootstrap(document.getElementsByTagName("body"),["mampfApp"])}},{"./config/constants.coffee":2,"./config/static.coffee":3,"./controllers/contacts/contact_details_ctrl.coffee":4,"./controllers/contacts/contact_list_ctrl.coffee":5,"./controllers/lunch/choose_contact_ctrl.coffee":6,"./controllers/lunch/choose_location_ctrl.coffee":7,"./controllers/lunch/lunch_request_ctrl.coffee":8,"./controllers/lunch/lunch_response_ctrl.coffee":9,"./controllers/profile/add_location_ctrl.coffee":10,"./controllers/profile/location_detail_ctrl.coffee":11,"./controllers/profile/profile_ctrl.coffee":12,"./controllers/profile/show_locations_ctrl.coffee":13,"./directives/shared_validate.coffee":14,"./factories/contact_chooser.coffee":15,"./factories/cordova_ready.coffee":16,"./factories/device.coffee":17,"./factories/geolocation.coffee":18,"./factories/server.coffee":19,"./factories/shared_data.coffee":20}],2:[function(e,t){var o;o={USE_GPS_LOCATION:0,USE_PREDEFINED_LOCATION:1,LOCATION_NOT_SET:2},t.exports=o},{}],3:[function(e,t){var o;o={server:"http://141.83.68.32/mampf",dummyContacts:[{displayName:"dummy",selected:!1,telephone:"+4917629322211",telephoneHash:"f828ffdfcd8b508cd0a9d16771a55745"},{displayName:"dummy2",selected:!1,telephone:"+4917629322212",telephoneHash:"2180878ef6bb945692cd66a0c053faf0"}],dummyLocations:[{locationName:"Footown",selected:!1,latitude:-6,longitude:-7},{locationName:"Bartown",selected:!1,latitude:-5,longitude:-8}],dummyUser:{telephone:"01522905094913",telephoneHash:"d949dd7b976c60f70f6492ee673d6768"}},t.exports=o},{}],4:[function(e,t){var o;o=["$scope","config","storage","sharedData",function(){}],t.exports=o},{}],5:[function(e,t){var o;o=["$scope","contactChooser","sharedData","storage","config","md5",function(e,t,o,n,r,c){return n.bind(e,"contacts",{defaultValue:r.dummyContacts}),e.toggleContact=function(t){return t.selected=!t.selected,o.contacts=e.contacts},e.contactAdd=function(){return t.get().then(function(t){var n,r;return console.log("contact",t,t.phoneNumbers.value),t.phoneNumbers&&(n=t.phoneNumbers[1].value).trim()&&(n=n.replace(/^\+49\s*/,0),r=c.createHash(""+n)),t={displayName:t.displayName,telephone:n,telephoneHash:r,selected:!1},console.log("contact after",t),e.contacts.push(t),o.contacts.length?o.contacts.push(t):void 0},function(e){return console.log("lol fehler",e)})}}],t.exports=o},{}],6:[function(e,t){var o;o=["$scope","config","storage","sharedData",function(e,t,o,n){var r,c,a,i;if(n.contacts.length)e.contactsForChoose=n.contacts;else for(e.contacts=o.get("contacts"),e.contactsForChoose=angular.copy(e.contacts),i=e.contactsForChoose,c=0,a=i.length;a>c;c++)r=i[c],r.selected=!1;return e.toggleContact=function(t){return t.selected=!t.selected,n.contacts=e.contactsForChoose}}],t.exports=o},{}],7:[function(e,t){var o;o=["$scope","config","storage","sharedData",function(e,t,o,n){var r,c,a,i;if(e.positionLocation=n.positionLocation||!1,n.locations.length)e.locationsForChoose=n.locations;else for(e.locations=o.get("locations"),e.locationsForChoose=angular.copy(e.locations),i=e.locationsForChoose,c=0,a=i.length;a>c;c++)r=i[c],r.selected=!1;return e.toggleLocation=function(t){var o,r,c,a;for(e.positionLocation=!1,a=e.locationsForChoose,r=0,c=a.length;c>r;r++)o=a[r],o.selected=!1;return t.selected=!t.selected,n.locations=e.locationsForChoose},e.setLocationPosition=function(){var t,o,r,c;for(c=e.locationsForChoose,o=0,r=c.length;r>o;o++)t=c[o],t.selected=!1;return e.positionLocation=!e.positionLocation,n.positionLocation=e.positionLocation}}],t.exports=o},{}],8:[function(e,t){var o;o=["$scope","sharedData","storage","config","constants","geoLocation","server","$q","$interval","$rootScope",function(e,t,o,n,r,c,a,i){var l,s;return o.bind(e,"user"),e.request={startTime:"12:00",endTime:"14:00"},e.getCurrentDateTime=function(){var t;return e.request.startTime=(new Date).toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}),t=(new Date).getTime()+72e5,e.request.endTime=new Date(t).toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"})},e.getCount=function(){return t.contacts.filter(function(e){return e.selected}).length},e.getSelectedLocationName=function(){var e,t,o;switch(o=s(),t=o[0],e=o[1],t){case r.USE_PREDEFINED_LOCATION:return e.length?e[0].locationName:null;case r.USE_GPS_LOCATION:return"Aktuelle Position ermitteln";case r.LOCATION_NOT_SET:return null;default:return null}},e.doRequest=function(){var o,n,r,c,i,s;return s=new Date,o=""+s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),c=new Date(Date.parse(""+o+", "+e.request.startTime)).toISOString(),n=new Date(Date.parse(""+o+", "+e.request.endTime)).toISOString(),r=t.contacts.filter(function(e){return e.selected}).map(function(e){return e.telephoneHash}),i=e.user.telephoneHash,l().then(function(e){var t;return t={identity:i,invitees:r,currentPosition:e,timeSlots:[{startTime:c,endTime:n}]},console.log("request",t),a.create({data:t}).then(function(e){return console.log("we have a response",e)})},function(){return console.log("oops error while retrieving coordinates")})},s=function(){var e;return e=t.locations.filter(function(e){return e.selected}),e.length?[r.USE_PREDEFINED_LOCATION,e]:t.positionLocation?[r.USE_GPS_LOCATION,null]:[r.LOCATION_NOT_SET,null]},l=function(){var e,t,o,n;switch(e=i.defer(),n=s(),o=n[0],t=n[1],o){case r.USE_PREDEFINED_LOCATION:t.length?e.resolve({longitude:t[0].longitude,latitude:t[0].latitude}):e.reject();break;case r.USE_GPS_LOCATION:c.getPosition().then(function(t){return e.resolve({latitude:t.coords.latitude,longitude:t.coords.longitude})},function(){return e.reject()});break;case r.LOCATION_NOT_SET:e.reject();break;default:e.reject()}return e.promise}}],t.exports=o},{}],9:[function(){},{}],10:[function(e,t){var o;o=["$scope","config","storage","sharedData","geoLocation",function(e,t,o,n,r){return o.bind(e,"locations",{defaultValue:t.dummyLocations}),e.locationModel="Ort "+(e.locations.length+1),e.mapOptions={center:new google.maps.LatLng(53.8353,10.6349),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP},e.addNewLocation=function(){var t,o,r;return t=e.marker.getPosition().lat(),o=e.marker.getPosition().lng(),r={locationName:e.locationModel,selected:!1,latitude:t,longitude:o},e.locations.push(r),n.locations.length?n.locations.push(r):void 0},e.mapClick=function(t,o){return e.setMarkerPosition(o[0].latLng.lat(),o[0].latLng.lng())},e.setMarkerPosition=function(t,o){return e.marker.setPosition(new google.maps.LatLng(t,o))},e.refreshPosition=function(){return r.getPosition().then(function(t){var o;return e.position=t,o={lat:t.coords.latitude,lng:t.coords.longitude},e.mampfMap&&e.mampfMap.setCenter(o),e.marker?e.marker.setPosition(o):e.marker=new google.maps.Marker({position:o,map:e.mampfMap})},function(e){return console.log("lol noch ein geo fehler",e)})},e.refreshPosition()}],t.exports=o},{}],11:[function(e,t){var o;o=["$scope","config","sharedData","$timeout","storage",function(e,t,o,n,r){return r.bind(e,"locations",{defaultValue:t.dummyLocations}),e.location=o.location,e.modalMapOptions={center:new google.maps.LatLng(e.location.latitude,e.location.longitude),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP},e.mapClick=function(t,o){var n,r,c;return c=[o[0].latLng.lat(),o[0].latLng.lng()],n=c[0],r=c[1],e.marker.setPosition(new google.maps.LatLng(n,r)),e.location.longitude=r,e.location.latitude=n},e.refreshPosition=function(){var t;if(e.modalMampfMap)return t={lat:e.location.latitude,lng:e.location.longitude},e.modalMampfMap.setCenter(t),e.marker?e.marker.setPosition(t):e.marker=new google.maps.Marker({position:t,map:e.modalMampfMap})},n(function(){return e.refreshPosition()},500)}],t.exports=o},{}],12:[function(e,t){var o;o=["$scope","md5","config","_","storage","sharedData",function(e,t,o,n,r,c){return r.bind(e,"user",{defaultValue:o.dummyUser}),c.user=e.user,e.$watch("user.telephone",n.debounce(function(o){return o?e.$apply(function(){return e.user.telephone=o.replace(" ",""),e.user.telephoneHash=t.createHash(""+e.user.telephone),c.user=e.user}):void 0},500))}],t.exports=o},{}],13:[function(e,t){var o;o=["$scope","config","storage","sharedData",function(e,t,o,n){return o.bind(e,"locations",{defaultValue:t.dummyLocations}),e.pushPage=function(e){return n.location=e,ons.navigator.pushPage("partials/profile/locationDetail.html",{animation:"fade"})},e.deleteAllSelected=function(){var t,o,n,r,c;for(r=e.locations.filter(function(e){return e.selected}),c=[],o=0,n=r.length;n>o;o++)t=r[o],c.push(e.deleteLocation(t));return c},e.deleteLocation=function(t){return e.locations.splice(e.locations.indexof(t),1)}}],t.exports=o},{}],14:[function(e,t){var o;o=function(){return{restrict:"A",require:"ngModel",link:function(e,t,o,n){return console.log("it works"),e.$watch(o.sharedValidate,function(e){var t,r;return r=parseInt(n.$viewValue.replace(":","")),e=parseInt(e.replace(":","")),t=!0,"request.startTime"===o.ngModel?(t=e>=r,n.$setValidity("lessThan",t)):"request.endTime"===o.ngModel?(t=r>=e,n.$setValidity("greaterThan",t)):void 0})}}},t.exports=o},{}],15:[function(e,t){var o;o=["$window","$timeout","$q",function(e,t,o){var n;return n=function(){var e;return e=o.defer(),navigator.contacts.pickContact(function(t){return e.resolve(t)},function(t){return e.reject(t)}),e.promise},{get:n}}],t.exports=o},{}],16:[function(e,t){var o;o=["$q","$rootScope","$document",function(e,t,o){var n;return n=e.defer(),o.bind("deviceready",function(){return t.$apply(n.resolve)}),{ready:function(){return n.promise}}}],t.exports=o},{}],17:[function(e,t){var o;o=function(){var e,t,o,n,r;for(t={},r=["cordova","model","name","platform","uuid","version"],o=0,n=r.length;n>o;o++)e=r[o],t[e]="undefined"!=typeof device&&null!==device?device[e]:null;return t},t.exports=o},{}],18:[function(e,t){var o;o=["$q",function(e){var t;return t=function(){var t;return t=e.defer(),navigator.geolocation.getCurrentPosition(function(e){return t.resolve(e)},function(e){return t.reject(e)},{maximumAge:5e3,timeout:5e3,enableHighAccuracy:!0}),t.promise},{getPosition:t}}],t.exports=o},{}],19:[function(e,t){var o;o=["$http","config",function(e,t){var o;return o=function(o){return e({method:o.method,url:""+t.server,data:o.data})},{create:function(e){return o(angular.extend(e,{method:"POST"}))},update:function(e){return o(angular.extend(e,{method:"PUT"}))},"delete":function(e){return o(angular.extend(e,{method:"DELETE"}))},get:function(e){return o(angular.extend(e,{method:"GET"}))}}}],t.exports=o},{}],20:[function(e,t){var o;o=function(){return{contacts:[],locations:[]}},t.exports=o},{}]},{},[1]);